# N2pcBiophysicalModeling
 Biophysical Modeling of the Columnar/Laminar Origin of the N2pc.

Main analysis code for figures in Herrera and Westerberg et al. 2021.

## Plataform
MatLab (created in MatLab 2018b)

## Description
- [compCSD_splineiCSDmethod.m](compCSD_splineiCSDmethod.m): code to estimate the current source density (CSD) from the local field potentials (LFPs) using the cubic spline iCSD method from [Pettersen et al. 2006, *Journal of neuroscience methods*, 154(1-2), 116-133](https://www.sciencedirect.com/science/article/pii/S0165027005004541). Dependencies: [CSDplotter-master](https://github.com/beaherrera/2-compartments_L5-PC_model/tree/master/Toolbox).
- [compDipEEGfromCSD.m](compDipEEGfromCSD.m): code to estimate the EEG generated by two dipoles (one in each hemisphere) located in the brain of a macaque monkey, whose current dipole moments are calculated from the CSD patterns evoked by the LFPs recorded intracranially with a linear probe. This function will output the current dipole moments estimated from the CSD and the EEG evoked by their combine activation. Both data sets will be saved in a .mat file in the folder designated by you.

## Analysis steps
1. (Optional) Run [compCSD_splineiCSDmethod.m](compCSD_splineiCSDmethod.m) first if you do not have the CSD data or wish to use the cubic spline iCSD method.
2. Run [compDipEEGfromCSD.m](compDipEEGfromCSD.m) to estimate the current dipole moments and the EEG generated by them.

## License
Copyright (C) 2021 Beatriz Herrera, Jacob A. Westerberg, Michelle S. Schall, Alexander Maier, Geoffrey F. Woodman, Jorge J. Riera, and Jeffrey D. Schall.

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

[GNU GPLv3](https://choosealicense.com/licenses/gpl-3.0/)

## Citation

